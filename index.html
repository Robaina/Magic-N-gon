<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="A math game where one has to locate numbers in a graph such that the three numbers in each graph edge must add up to a specified quantity. It's solved with an integer linear program. Represented with Cytoscape.js">
    <meta name="keywords" content="magic n-gon, milp, integer linear program">
    <meta name="author" content="Semidán Robaina Estévez">
  	<meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Magic-Gon</title>
    <link rel="icon" type="image/png" href="n-gon.png">
    <script src="glpk.min.js"></script>
    <script src="cytoscape.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Anton|Coda" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">

    <!-- Sets $ as inline MathJax symbols -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
      });
    </script>

    <!-- Allows MathJax in the document-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=default" async></script>
  </head>

  <body>

    <div id="title-container">
      <h1 id="title">The n-Gon game</h1>
    </div>

    <div id="graph-container">
      <div class="graph" id="cy"></div>
    </div>

    <div class="button-container">
      <button type="button" name="button" id="four-button" class="button" onclick="set4Gon()">4-gon</button>
      <button type="button" name="button" id="five-button" class="button" onclick="set5Gon()">5-gon</button>
      <button type="button" name="button" id="six-button" class="button" onclick="set6Gon()">6-gon</button>
      <button type="button" name="button" id="solve-button" class="button" onclick="solveGame()">Solve!</button>
    </div>

    <article id="about">
      <h2 style="text-align: center;">What to do?</h2>

      <p id="what-to-do"></p>

      <p>To fill in the numbers, click or touch a circle and edit the value. You can press the <em>Solve!</em> button at any time to solve the game. You can change the polygon from a square to a hexagon by pressing the corresponding buttons. To reset the game, just press the button corresponding to the current n-Gon.</p>


      <h2 style="text-align: center;">What is this?</h2>

      <p>A while ago, I got intrigued by one of the mathematical puzzles proposed by the Plus Magazine &mdash; an online magazine about math &mdash; it was called <a href="https://plus.maths.org/content/magic-19">Magic 19</a>. The puzzle consisted of allocating numbers from 1 to 19 to each of the 19 vertices of a graph with a hexagonal shape, such that each triad of vertices on the same edge had to add up to 22. To be honest, I was not intrigued by the puzzled itself, but by a reader's comment which said that this problem made an excellent case to be solved by linear programming.</p>

      <p>Here, I transform Magic 19 into an <a href="https://en.wikipedia.org/wiki/Integer_programming">Integer Linear Program</a> (ILP) &mdash; similarly to what I did to build a <a href="https://robaina.github.io/Sudoku">Sudoku solver</a>. An ILP optimizes a linear objective function over a feasible domain, which is defined by a set of linear constraints, plus the addition that all variables must have integer values. Then, solving the puzzle is a matter of finding a feasible solution to the ILP.</p>

      <!-- <p>Each cell in the Sudoku grid, situated in row $i$ and column $j$ has 9 binary variables assigned: $x_{ijn} \;\,\forall n \in {1,...,9}$. These variables represent all possible values that a cell can have, for instance, if the cell in the first row and first column on the grid has a value of 1, then $x_{111} = 1$. After defining the binary variables, it isn't hard to define an ILP whose solution will be a Sudoku solution:</p>

      <div id="ilp">
        <p>
          $\max\limits_{x} \; 0$ <br>
          s.t. <br>
          <br>
          $\sum\limits_{n=1}^{9} x_{ijn} = 1 \;\; \,\forall i,j \;\; (1)$ <br>
          $\sum\limits_{j=1}^{9} x_{ijn} = 1 \;\; \,\forall i,n \;\; (2)$ <br>
          $\sum\limits_{i=1}^{9} x_{ijn} = 1 \;\; \,\forall j,n \;\; (3)$ <br>
          $\sum\limits_{i,j \in \; \text{S}} x_{ijn} = 1 \;\; \,\forall \; \text{S} \;,n \;\; (4)$ <br>
          $x_{ijn} = 1 \;\; \,\forall i,j,n \in \text{I} \;\; (5)$
        </p>
      </div>

      <p>The constraints in this ILP define the feasible Sudoku solution space. Specifically, the constraints in (1) guarantee that each cell in the grid gets only one number $n$ assigned, the constraints in (2) and in (3) restrict rows and columns, respectively, to have all numbers from 1 to 9 and the constraints in (4) guarantee that all squares (S) in the grid contain all numbers from 1 to 9. Finally, the constraints in (5) enforce the initial clues that you typed in before solving. To this end, it constraints each variable in the set of initial clues $\text{I}$ to have a value of 1, for instance, in the sample Sudoku, the cell in the first row and the second column has a value of 2, hence $x_{112} = 1 \,$ is included in the set of constraints in (5).</p>

      <p>As a side note, in this case we not care about the objective function of the ILP, here set to maximize a constant! This is because a <a href="https://en.wikipedia.org/wiki/Mathematics_of_Sudoku">proper Sudoku game</a>, that is, one with the correct set of initial clues, has only one possible solution. Therefore, the feasible space defined by all constraints, including the proper initial clues, contains only one solution, and the optimization of any objective function will render it as a result. However, if an insufficient number of initial clues is given, the feasible space can contain more than one solution. In this case, the algorithm behind the ILP solver&mdash;<a href="http://hgourvest.github.io/glpk.js/">Glpk.js</a> in this case&mdash;will retrieve the first feasible solution it encounters.</p> -->
    </article>

    <footer>
      <p><a href="https://semidanrobaina.com">Semidán Robaina Estévez</a>, 2020.<br/>
      Using <a href="https://hgourvest.github.io/glpk.js/">glpk.js</a> and <a href="https://js.cytoscape.org/">cytoscape.js</a> libraries.</p>
    </footer>

    <script src="ilp.js"></script>

  </body>
</html>
